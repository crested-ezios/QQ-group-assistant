# QQ群基建副手

## 简要介绍

基于 mirai-console 的多群联合+群分类管理QQ机器人插件

## 目标用户群体

有很多QQ群需要合并管理和分类管理的用户，例如：使用QQ进行办公的事业单位员工群的管理\*；教育用户对学生相关群的管理；产品运营商对售后群的管理；活动组织者对多个事件群的管理；社团组织者对社员群的管理；网络平台Up主/网红团队对粉丝群的管理；其它对大量类型相似的群进行批量管理的用户。

\*注：目前根据非官方消息，有很多公司近期内部要求不允许使用腾讯系应用进行办公，故不将此需求作为主要开发需求

## 功能介绍

### 群模板和群联合

支持设置群模板功能，将有相同点的多个QQ群用相同的群模板进行管理，同时也可以将这些QQ群组成群联合，在同一个群联合内，副手将会对这些群进行统一管理。

#### 概念介绍

群设置：

针对某个QQ群的群管理设置，可以自定义某些功能对该QQ群的开关等。具体功能会在下文列出。

群模板：

一种群管理策略，使用户可以为某一类群声明一种一般的管理逻辑，而不具体针对某个QQ群。

模板群：

基于某个群模板策略管理的QQ群称为模板群，也称该模板的管理实例。注意：使用模板群策略进行管理的QQ群仍然可以自定义群设置，后者如与前者有冲突则会覆盖前者。

群联合：

如果多个QQ群使用同一个群模板进行管理，则用户可以选择将多个QQ群链接到一起，形成群联合。群联合的成员群就是每个所包含的QQ群，而成员群的成员则是每一个具体的QQ用户。群在联合后，成员群之间可以进行有限的交互（如通过群联合留言板），同时群联合的总管理员也可以更方便地统一管理成员群（例如统一发送通知）。

#### 场景举例：

某网游公会有多个QQ群，公会管理员将这些群划分进一个群联合，在以公会为单位活动时进行统一调配。

某公司管理员将职员群按照不同部门进行模板划分，每个部门大类有不同的管理模式和推送机制（例如IT设计员工群和平面设计员工群都属于设计大类）。

某Up主将粉丝群按照不同级别划分成总督/提督群、舰长群、普通粉丝群，每种类型的群分别有不同的群规和Up相关活动消息推送（比如总督们可以有单独的限定活动）。

## 使用文档

### 群管理功能

以下列出的是针对某个具体QQ群的群管理功能清单（默认机器人身份为群主或群管理）。

#### 群信息

##### 群资料

查看当前QQ群的资料卡。

##### 群每日简报

在这里获取每日当前QQ群的简报。左划可以查看最近1周内的每日简报。另外，可以设置每日向管理员发送文字形式的简报。

简报内容包括：进/退/待进群人数、发言人数（展开可查看发言频次）、潜水人数、新人留存率、关键词云、群公告数量及确认率（展开可查看具体公告和对应确认人数）、群待办数量及确认率（展开可查看具体群待办和对应确认人数）、\@全体成员数量（展开可查看每条\@全体成员消息的具体内容）等。

##### 群消息窗口

在这里实时查看当前的群消息，也可以通过编辑框发送文本、群公告或自定义消息（基于XML卡片）到群内。

#### 群编辑

##### 群成员列表

在这里可以添加成员、对某个成员设置代管\*权限和删除成员。

\*注：

代管权限有三个等级：

A级：超级管理员权限，默认群主拥有此权限，该权限可以使用全部群管指令和自定义指令。如果机器人为群主，则可以指定一个B级成员获得此权限，也可以空置该权限。

B级：高级管理员权限，默认QQ群管理员拥有此权限，该权限可以使用全部已开启的群管指令。如果机器人账号身份非群主，则无法设置B级成员权限。

C级：辅助管理员权限，该权限可以利用对其开放的指令完成部分管理员操作。不同C级权限用户使用的指令集可以进行自定义，以便各司其职（例如让一人专职辅助入群审核，另一人专职辅助群聊监控）。

##### 群指令设置

这里会列出所有可用指令（包括群管指令和普通指令），可以对其进行自定义。自定义内容包括某条指令的开关、指令权限等级、指令触发文本和指令响应文本，部分指令包含其它设置。

##### 群事件设置

> 群事件包括进群、退群和管理变动。默认情况下，机器人会遵循如下逻辑：

有人进群时，机器人会在群内发送一段欢迎文本，然后对新人私聊发送一段告知文本。

有人退群时，机器人会在群内发送一段告别文本，如果是被管理员直接踢出，则会在群内发送另一段警告文本。如果是被机器人踢出，机器人会根据触犯规则原因在群内生成一段警告文本，并转发给被踢的人。如管理员选择通过机器人进行踢人，则可以临时自定义警告文本（仅当次生效），并可选择转发给被踢的人。

管理变动时，机器人会在群内发送管理员变动文本，并私聊当事人告知。

上述所有逻辑均可以自定义开关和具体发送文本内容。

#### 入群审核

此处可以自定义入群审核开关，并自定义审核条件和处理方式。目前审核条件支持：黑名单审核、资料关键词审核（例如资料中出现广告等，需要启用1.4.1.4.2内容审核功能）、申请理由审核、入群方式审核（例如拒绝从未发言的群成员邀请的人）等。目前处理方式支持将一部分基于审核结果直接进行同意/拒绝操作，另一部分审核结果推送给有关管理员作为参考，待其作出决策（可以全部是前者或后者）。

#### 聊天管理

##### 刷屏/复读管理

如果有人短时间内多次发言，或者一次性发言字数过多，则认为其有刷屏嫌疑。如果有多个人在一段时间内发送同样的文本或图片，则认为有复读嫌疑。在这里可以开启该管理开关，并且自定义触发机制和制裁措施（例如打断复读、警告、禁言和踢人）。

##### 内容审核

在打开文本审核开关后，机器人将自动审核文本、图片和视频中令人反感、不安全或不适宜内容并实施制裁（例如撤回、警告、禁言和踢人），支持自定义关键词和处罚措施。另可设定将不良内容备案至指定位置后再实施制裁。

注：用户若需要该功能，请自行前往主流AI开放平台（例如百度智能云、腾讯云、阿里云等）购买能力并在机器人处设置接口。

注2：如机器人无法正常进行内容审核，请检查是否登录了该机器人的电脑端QQ。

##### 文件整理

在打开文件整理开关后，此处可以自定义文件整理规则，让机器人基于规则（例如基于名字或后缀名）将群文件进行自动整理。

##### 自定义回复

> 可以在此处自定义一问一答列表。具体编辑规则请查看帮助。

##### 任务指派

此处可自定义机器人行为，让其在某个时间点执行指定任务（例如发送某段信息），抑或在某指定时间段循环执行指定任务（例如每天固定时间开启/关闭全群禁言）。

#### 退群规则

##### 踢人规则

此处可以设置在某些情况下机器人自动踢人，例如进群一段时间内从未发言，或者被警告次数超过某个限度等。也可以设置在群人数超限后基于条件筛选进行踢人以控制群人数。踢人后可以设置拉入本群黑名单。

##### 误踢恢复

此处会显示最近一周内由机器人/其他管理员踢出的群成员，如发现系误踢，可在此处尝试重新邀请群成员进群。进群后黑名单自动消失。

##### 黑/白名单

可在此处设置踢人的黑名单/白名单。黑名单成员将会被直接踢出并拒绝再次入群，白名单成员将不会因为触犯机器人踢人规则被踢出。

### 多群联合管理功能

#### 群联合信息

##### 群联合每日简报

在这里获取每日群联合的简报。群联合的简报是每个分群简报的整理汇总。左划可以查看最近1周内的每日简报。另外，可以设置每日向管理员发送文字形式的简报。

简报内容包括：进/退群总人数、发言总人数（展开可查看发言频次）、潜水总人数、新人总留存率、总关键词云、群公告总数量及确认率（展开可查看具体分群公告和对应确认人数）、群待办总数量及确认率（展开可查看具体分群待办和对应确认人数）、\@全体成员总数量（展开可查看分群每条\@全体成员消息的具体内容）等。

##### 群联合消息窗口

在这里实时查看当前的所有成员群消息，也可以通过编辑框向指定群发送文本或自定义消息（基于XML卡片）。

#### 跨群交流功能

##### 多群公告

> 在这里可以编辑并向群联合内选中的多个群发送群公告、\@全体成员消息和消息卡片。

##### 多群直播（实验性功能）

通过此处可以在多个内实现同时直播。方式为设定一个直播主群，机器人会将主群的直播以群直播的方式在分群同步转播，并将分群的文字互动转发回主群。分群无法进行语音互动。

##### 多群邮件

此处可以控制该功能的开关和自定义邮件系统设置。通过多群邮件系统，各成员群的普通成员可以通过机器人互相传递消息。

##### 多群留言板

此处可以管理群留言板的功能设置。群联合的各成员群的达到指定活跃等级的普通成员都可以向留言板上新增留言，留言板的内容将在所有成员群同步。如果留言板上的留言总字数或总条数达到限制，将会在新增留言时清除最早的留言。达到指定活跃等级的普通成员每日可以有限次数地换出留言板。

#### 群联合编辑

##### 群联合成员列表

在这里设置群联合的代管权限\*，也可以向某个成员群添加成员、对某个成员设置代管权限和删除成员。

\*注：

群联合的代管权限有两个等级：

V级：群联合主权限，需指定一人拥有此权限，该权限可以对群联合下所有成员群使用全部群管指令。

S级：群联合辅助管理员权限，该权限可以对群联合下所有群使用对其开放的指令完成部分管理员操作。不同S级权限用户使用的指令集可以进行自定义，以便各司其职（例如让一人专职辅助入群审核，另一人专职辅助群聊监控）。

其余A、B、C级成员权限对应单个成员群，具体描述见单个群的群管功能介绍。

##### 管理员群

为了方便群联合的成员群管理员之间共同议事，互通有无，建议组建一个由所有代管组成的管理员群。该群可以直接填写已经存在的群号，也可以由机器人自动组建。代管可以在管理员群内发送群指令，机器人将会到对应群执行（注：V、S级成员需要指定执行群的群编号，A、B、C级成员直接发送即可）。如无需此功能，则群号一栏留空即可。

##### 群指令设置

这里会列出所有可用指令（包括群管指令和普通指令），可以对其进行自定义。自定义内容包括某条指令的开关、指令权限等级、指令触发文本和指令响应文本，部分指令包含其它设置。成员群若对此有单独设置，则以对应群设置为准。

##### 群事件设置

> 群事件包括进群、退群和管理变动。默认情况下，机器人会遵循如下逻辑：

有人进群时，机器人会在群内发送一段欢迎文本，然后对新人私聊发送一段告知文本。

有人退群时，机器人会在群内发送一段告别文本，如果是被管理员直接踢出，则会在群内发送另一段警告文本。如果是被机器人踢出，机器人会根据触犯规则原因在群内生成一段警告文本，并转发给被踢的人。如管理员选择通过机器人进行踢人，则可以临时自定义警告文本（仅当次生效），并可选择转发给被踢的人。

管理变动时，机器人会在群内发送管理员变动文本，并私聊当事人告知。

上述所有逻辑均可以自定义开关和具体发送文本内容。成员群若对此有单独设置，则以对应群设置为准。

#### 入群审核

此处可以自定义入群审核开关，并自定义审核条件和处理方式。目前审核条件支持：黑名单审核、资料关键词审核（例如资料中出现广告等，需要启用1.4.1.4.2内容审核功能）、申请理由审核、入群方式审核（例如拒绝从未发言的群成员邀请的人）等。目前处理方式支持将一部分基于审核结果直接进行同意/拒绝操作，另一部分审核结果推送给有关管理员作为参考，待其作出决策（可以全部是前者或后者）。成员群若对此有单独设置，则以对应群设置为准。

#### 聊天管理

##### 刷屏/复读管理

如果有人短时间内多次发言，或者一次性发言字数过多，则认为其有刷屏嫌疑。如果有多个人在一段时间内发送同样的文本或图片，则认为有复读嫌疑。在这里可以开启该管理开关，并且自定义触发机制和制裁措施（例如打断复读、警告、禁言和踢人）。成员群若对此有单独设置，则以对应群设置为准。

##### 内容审核

在打开文本审核开关后，机器人将自动审核文本、图片和视频中令人反感、不安全或不适宜内容并实施制裁（例如撤回、警告、禁言和踢人），支持自定义关键词和处罚措施。另可设定将不良内容备案至指定位置后再实施制裁。成员群若对此有单独设置，则以对应群设置为准。

注：用户若需要该功能，请自行前往主流AI开放平台（例如百度智能云、腾讯云、阿里云等）购买能力并在机器人处设置接口。

注2：如机器人无法正常进行内容审核，请检查是否登录了该机器人的电脑端QQ。

##### 文件整理/共享

在打开文件整理开关后，此处可以自定义文件整理规则，让机器人基于规则（例如基于名字或后缀名）将群文件进行自动整理。打开群文件共享开关后，成员群的成员可以通过机器人下载其它成员群的文件。成员群若对此有单独设置，则以对应群设置为准。

##### 自定义回复

可以在此处自定义一问一答列表。具体编辑规则请查看帮助。成员群若对此有单独设置，则以对应群设置为准。

##### 任务指派

此处可自定义机器人行为，让其在某个时间点执行指定任务（例如发送某段信息），抑或在某指定时间段循环执行指定任务（例如每天固定时间开启/关闭全群禁言）。

#### 退群规则

##### 踢人规则

此处可以设置在某些情况下机器人自动踢人，例如进群一段时间内从未发言，重复进入群联合下的其它成员群，或者被警告次数超过某个限度等。也可以设置在群人数超限后基于条件筛选进行踢人以控制群人数。踢人后可以设置拉入全局黑名单或单群黑名单。

##### 误踢恢复

此处会显示最近一周内由机器人/其他管理员踢出的成员群成员，如发现系误踢，可在此处尝试重新邀请群成员进群。进群后黑名单自动消失。

##### 黑/白名单

可在此处设置踢人的黑名单/白名单。黑名单成员将会被直接踢出并拒绝再次入群，白名单成员将不会因为触犯机器人踢人规则被踢出。

### 群模板管理功能

> 简要介绍：可创建多个群模板，然后在某个分群或群联合设置中直接导入该模板的设置。
